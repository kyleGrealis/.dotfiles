#!/usr/bin/env bash

#=================================================================
# backup-arch
# Purpose: Backup Arch package lists to dotfiles repository
# Author: Kyle Grealis
# Date: October 10, 2025
#=================================================================

DOTFILES="$HOME/dotfiles"
DATE=$(date +"%Y-%m-%d %H:%M")

echo "üì¶ Backing up Arch package lists..."

pacman -Qqe > "$DOTFILES/arch-packages.txt"
pacman -Qqm > "$DOTFILES/aur-packages.txt"

echo "‚úì Package lists updated"

cd "$DOTFILES"
git add arch-packages.txt aur-packages.txt

if git diff --staged --quiet; then
    echo "‚ÑπÔ∏è  No changes to commit"
else
    git commit -m "updated: $DATE"
    git push
    echo "‚úì Changes committed and pushed"
fi
